//©///////////////////////////////////////////////////////////////////////////©//
//
//  Copyright 2021-2025 BIA-Technologies Limited Liability Company
//
//  Licensed under the Apache License, Version 2.0 (the "License");
//  you may not use this file except in compliance with the License.
//  You may obtain a copy of the License at
//
//      http://www.apache.org/licenses/LICENSE-2.0
//
//  Unless required by applicable law or agreed to in writing, software
//  distributed under the License is distributed on an "AS IS" BASIS,
//  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
//  See the License for the specific language governing permissions and
//  limitations under the License.
//
//©///////////////////////////////////////////////////////////////////////////©//

#Область СлужебныйПрограммныйИнтерфейс

Процедура ИсполняемыеСценарии() Экспорт
	
	ЮТТесты
		.ДобавитьТест("ВызватьМетодМодуля_БезПараметров")
		.ДобавитьТест("ВызватьМетодМодуля_СПараметрами")
		.ДобавитьТест("ВызватьМетодОбъекта_БезПараметров")
		.ДобавитьТест("ВызватьМетодОбъекта_СПараметрами")
		.ДобавитьТест("МассивПараметров_РазноеКоличество")
		.ДобавитьТест("МассивПараметров_СПропусками")
		.ДобавитьТест("ПараметрПоУмолчанию_ПроверкаЗначения")
		.ДобавитьТест("ВызватьФункциюКонфигурации_БезПараметров")
		.ДобавитьТест("ВызватьФункциюКонфигурации_СПараметрами");
	
КонецПроцедуры

#Область ВспомогательныеМетодыИмитацииМодуля

Процедура Имитация_ТестоваяПроцедураБезПараметров() Экспорт
	ЮТест.Контекст().УстановитьЗначение("ОМ_ЮТМетоды_ИмитацияМодуля_БылВызов", Истина);
КонецПроцедуры

Процедура Имитация_ТестоваяПроцедураСПараметрами(Парам1, Парам2) Экспорт
	ЮТест.Контекст().УстановитьЗначение("ОМ_ЮТМетоды_ИмитацияМодуля_БылВызов", Истина);
	ПараметрыВызова = ЮТКоллекции.ЗначениеВМассиве(Парам1, Парам2);
	ЮТест.Контекст().УстановитьЗначение("ОМ_ЮТМетоды_ИмитацияМодуля_ПоследниеПараметры", ПараметрыВызова);
КонецПроцедуры

Функция Имитация_ТестоваяФункцияБезПараметров() Экспорт
	ЮТест.Контекст().УстановитьЗначение("ОМ_ЮТМетоды_ИмитацияМодуля_БылВызов", Истина);
	Возврат ЮТест.Контекст().Значение("ОМ_ЮТМетоды_ИмитацияМодуля_ВозвращаемоеЗначение");
КонецФункции

Функция Имитация_ТестоваяФункцияСПараметрами(Парам1, Парам2) Экспорт
	ЮТест.Контекст().УстановитьЗначение("ОМ_ЮТМетоды_ИмитацияМодуля_БылВызов", Истина);
	ПараметрыВызова = ЮТКоллекции.ЗначениеВМассиве(Парам1, Парам2);
	ЮТест.Контекст().УстановитьЗначение("ОМ_ЮТМетоды_ИмитацияМодуля_ПоследниеПараметры", ПараметрыВызова);
	Возврат ЮТест.Контекст().Значение("ОМ_ЮТМетоды_ИмитацияМодуля_ВозвращаемоеЗначение");
КонецФункции

#КонецОбласти

#Область ТестыВызватьМетодМодуля

Процедура ВызватьМетодМодуля_БезПараметров() Экспорт
	ЮТест.Контекст().УстановитьЗначение("ОМ_ЮТМетоды_ИмитацияМодуля_БылВызов", Ложь);
	
	ЮТМетоды.ВызватьМетодМодуля("ОМ_ЮТМетоды", "Имитация_ТестоваяПроцедураБезПараметров");
	
	ЮТест.ОжидаетЧто(ЮТест.Контекст().Значение("ОМ_ЮТМетоды_ИмитацияМодуля_БылВызов"))
		.ЭтоИстина("Метод модуля без параметров не был вызван.");
КонецПроцедуры

Процедура ВызватьМетодМодуля_СПараметрами() Экспорт
	ЮТест.Контекст().УстановитьЗначение("ОМ_ЮТМетоды_ИмитацияМодуля_БылВызов", Ложь);
	ЮТест.Контекст().УстановитьЗначение("ОМ_ЮТМетоды_ИмитацияМодуля_ПоследниеПараметры", Неопределено);
	
	ПараметрыВызова = ЮТКоллекции.ЗначениеВМассиве("Строка1", 123);
	ЮТМетоды.ВызватьМетодМодуля("ОМ_ЮТМетоды", "Имитация_ТестоваяПроцедураСПараметрами", ПараметрыВызова);
	
	ЮТест.ОжидаетЧто(ЮТест.Контекст().Значение("ОМ_ЮТМетоды_ИмитацияМодуля_БылВызов"))
		.ЭтоИстина("Метод модуля с параметрами не был вызван.");
	
	ПоследниеПараметры = ЮТест.Контекст().Значение("ОМ_ЮТМетоды_ИмитацияМодуля_ПоследниеПараметры");
	ЮТест.ОжидаетЧто(ПоследниеПараметры)
		.ИмеетДлину(2)
		.Свойство("[0]").Равно("Строка1")
		.Свойство("[1]").Равно(123);
КонецПроцедуры

#КонецОбласти

#Область ТестыВызватьМетодОбъекта

Процедура ВызватьМетодОбъекта_БезПараметров() Экспорт
	ЮТест.Контекст().УстановитьЗначение("ОМ_ЮТМетоды_ИмитацияМодуля_БылВызов", Ложь);
	
	ЮТМетоды.ВызватьМетодОбъекта(ОМ_ЮТМетоды, "Имитация_ТестоваяПроцедураБезПараметров");
	
	ЮТест.ОжидаетЧто(ЮТест.Контекст().Значение("ОМ_ЮТМетоды_ИмитацияМодуля_БылВызов"))
		.ЭтоИстина("Метод объекта без параметров не был вызван.");
КонецПроцедуры

Процедура ВызватьМетодОбъекта_СПараметрами() Экспорт
	ЮТест.Контекст().УстановитьЗначение("ОМ_ЮТМетоды_ИмитацияМодуля_БылВызов", Ложь);
	ЮТест.Контекст().УстановитьЗначение("ОМ_ЮТМетоды_ИмитацияМодуля_ПоследниеПараметры", Неопределено);
	
	ПараметрыВызова = ЮТКоллекции.ЗначениеВМассиве(Дата(2023,1,1), Истина);
	ЮТМетоды.ВызватьМетодОбъекта(ОМ_ЮТМетоды, "Имитация_ТестоваяПроцедураСПараметрами", ПараметрыВызова);
	
	ЮТест.ОжидаетЧто(ЮТест.Контекст().Значение("ОМ_ЮТМетоды_ИмитацияМодуля_БылВызов"))
		.ЭтоИстина("Метод объекта с параметрами не был вызван.");
	
	ПоследниеПараметры = ЮТест.Контекст().Значение("ОМ_ЮТМетоды_ИмитацияМодуля_ПоследниеПараметры");
	ЮТест.ОжидаетЧто(ПоследниеПараметры)
		.ИмеетДлину(2)
		.Свойство("[0]").Равно(Дата(2023,1,1))
		.Свойство("[1]").Равно(Истина);
КонецПроцедуры

#КонецОбласти

#Область ТестыМассивПараметров

Процедура МассивПараметров_РазноеКоличество() Экспорт
	Массив0 = ЮТМетоды.МассивПараметров();
	ЮТест.ОжидаетЧто(Массив0).ИмеетДлину(0, "Пустой вызов МассивПараметров должен вернуть пустой массив");
	
	Массив1 = ЮТМетоды.МассивПараметров("Парам1");
	ЮТест.ОжидаетЧто(Массив1)
		.ИмеетДлину(1)
		.Свойство("[0]").Равно("Парам1");
	
	Массив3 = ЮТМетоды.МассивПараметров("Парам1", 123, Ложь);
	ЮТест.ОжидаетЧто(Массив3)
		.ИмеетДлину(3)
		.Свойство("[0]").Равно("Парам1")
		.Свойство("[1]").Равно(123)
		.Свойство("[2]").Равно(Ложь);
	
	Массив10 = ЮТМетоды.МассивПараметров(1,2,3,4,5,6,7,8,9,10);
	ЮТест.ОжидаетЧто(Массив10).ИмеетДлину(10);
	ЮТест.ОжидаетЧто(Массив10[9]).Равно(10);
КонецПроцедуры

Процедура МассивПараметров_СПропусками() Экспорт
	ЗначениеПоУмолчанию = ЮТМетоды.ПараметрПоУмолчанию();
	
	Массив = ЮТМетоды.МассивПараметров("Парам1", , "Парам3", ,"Парам5");
	ЮТест.ОжидаетЧто(Массив)
		.ИмеетДлину(5)
		.Свойство("[0]").Равно("Парам1")
		.Свойство("[1]").Равно(ЗначениеПоУмолчанию)
		.Свойство("[2]").Равно("Парам3")
		.Свойство("[3]").Равно(ЗначениеПоУмолчанию)
		.Свойство("[4]").Равно("Парам5");
КонецПроцедуры

#КонецОбласти

#Область ТестыПараметрПоУмолчанию

Процедура ПараметрПоУмолчанию_ПроверкаЗначения() Экспорт
	ОжидаемоеЗначение = "<[ЗначениеВходногоПараметраПоУмолчанию]>";
	РеальноеЗначение = ЮТМетоды.ПараметрПоУмолчанию();
	ЮТест.ОжидаетЧто(РеальноеЗначение).Равно(ОжидаемоеЗначение);
КонецПроцедуры

#КонецОбласти

#Область ТестыВызватьФункциюКонфигурации

Процедура ВызватьФункциюКонфигурации_БезПараметров() Экспорт
	ОжидаемыйРезультат = "РезультатФункцииБезПараметров";
	ЮТест.Контекст().УстановитьЗначение("ОМ_ЮТМетоды_ИмитацияМодуля_ВозвращаемоеЗначение", ОжидаемыйРезультат);
	ЮТест.Контекст().УстановитьЗначение("ОМ_ЮТМетоды_ИмитацияМодуля_БылВызов", Ложь);
	
	Результат = ЮТМетоды.ВызватьФункциюКонфигурации("ОМ_ЮТМетоды", "Имитация_ТестоваяФункцияБезПараметров");
	
	ЮТест.ОжидаетЧто(ЮТест.Контекст().Значение("ОМ_ЮТМетоды_ИмитацияМодуля_БылВызов"))
		.ЭтоИстина("Функция модуля без параметров не была вызвана.");
	ЮТест.ОжидаетЧто(Результат).Равно(ОжидаемыйРезультат);
КонецПроцедуры

Процедура ВызватьФункциюКонфигурации_СПараметрами() Экспорт
	ОжидаемыйРезультат = "РезультатСПараметрами";
	ЮТест.Контекст().УстановитьЗначение("ОМ_ЮТМетоды_ИмитацияМодуля_ВозвращаемоеЗначение", ОжидаемыйРезультат);
	ЮТест.Контекст().УстановитьЗначение("ОМ_ЮТМетоды_ИмитацияМодуля_БылВызов", Ложь);
	ЮТест.Контекст().УстановитьЗначение("ОМ_ЮТМетоды_ИмитацияМодуля_ПоследниеПараметры", Неопределено);
	
	ПараметрыВызова = ЮТКоллекции.ЗначениеВМассиве("ПарамФункции", 99);
	Результат = ЮТМетоды.ВызватьФункциюКонфигурации("ОМ_ЮТМетоды", "Имитация_ТестоваяФункцияСПараметрами", ПараметрыВызова);
	
	ЮТест.ОжидаетЧто(ЮТест.Контекст().Значение("ОМ_ЮТМетоды_ИмитацияМодуля_БылВызов"))
		.ЭтоИстина("Функция модуля с параметрами не была вызвана.");
	ЮТест.ОжидаетЧто(Результат).Равно(ОжидаемыйРезультат);
	
	ПоследниеПараметры = ЮТест.Контекст().Значение("ОМ_ЮТМетоды_ИмитацияМодуля_ПоследниеПараметры");
	ЮТест.ОжидаетЧто(ПоследниеПараметры)
		.ИмеетДлину(2)
		.Свойство("[0]").Равно("ПарамФункции")
		.Свойство("[1]").Равно(99);
КонецПроцедуры

#КонецОбласти

#КонецОбласти
