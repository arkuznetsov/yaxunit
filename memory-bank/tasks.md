# Задача: Исправление тегов Allure для дымовых тестов (Issue #602)

## Описание проблемы
При выполнении дымовых тестов (smoke tests) теги Allure не применяются корректно. В частности, `parentSuite` остается 'Unit tests' вместо ожидаемого 'Smoke tests'.

## Текущее поведение
В Allure отчете для дымовых тестов отображается:
```json
{
  "parentSuite": "Unit tests",
  "epic": "ДТОткрытиеФорм",
  "suite": "ДТОткрытиеФорм"
}
```

## Ожидаемое поведение
Должно отображаться:
```json
{
  "parentSuite": "Smoke tests",
  "epic": "Smoke tests",
  "suite": "Дымовые тесты"
}
```

## Технические детали
- **Расширение:** Smoke (версия 0.2.1)
- **Модуль:** ДТОткрытиеФорм
- **Формат отчета:** Allure
- **Конфигурация:** smoke-config.json

## План выполнения

### Этап 1: Создание тестов для проверки поведения
1. Создать модульные тесты для проверки корректности формирования Allure тегов
2. Тесты должны проверять:
   - Правильность установки `parentSuite`
   - Корректность `epic` и `suite`
   - Приоритет настроек модуля над глобальными

### Этап 2: Анализ и исправление кода
1. Изучить логику формирования Allure отчета в YAxUnit
2. Определить причину приоритета глобальных настроек
3. Реализовать механизм переопределения тегов на уровне модуля

### Этап 3: Создание новой ветки
1. Создать ветку `feature/fix-allure-smoke-tags-602`
2. Внести изменения в код
3. Запустить тесты для проверки исправления

## Файлы для изменения
- `exts/smoke/src/CommonModules/ДТОткрытиеФорм/Module.bsl`
- `exts/yaxunit/src/CommonModules/ЮТОтчетAllureСлужебный/Module.bsl`
- `tests/src/` - добавление новых тестов

## Критерии приемки
1. ✅ Все smoke тесты отображаются с правильным `parentSuite: "Smoke tests"`
2. ✅ Настройки Allure на уровне модуля имеют приоритет над глобальными
3. ✅ Существующие тесты продолжают работать корректно
4. ✅ Новые тесты покрывают проверку поведения Allure тегов

## Приоритет
**Средний** - функциональность работает, но пользовательский опыт ухудшен из-за неправильной группировки тестов.

## Связанные ресурсы
- [Issue #602](https://github.com/bia-technologies/yaxunit/issues/602)
- [PR #601](https://github.com/bia-technologies/yaxunit/pull/601)

## Статус
✅ Завершено

## Выполненная работа

### ✅ Этап 1: Создание тестов для проверки поведения
- Создан тест `ТестИсправленияAllureТегов` в модуле `ОМ_ЮТОтчетAllureСлужебный`
- Тест проверяет корректность базового поведения и возможность переопределения тегов
- Добавлен в список исполняемых сценариев

### ✅ Этап 2: Анализ и исправление кода
- **Проблема найдена**: В функции `ИерархияТеста` жестко прописан `parentSuite = "Unit tests"`
- **Исправлено**: Добавлена логика переопределения через настройки модуля
- **Файл**: `exts/yaxunit/src/CommonModules/ЮТОтчетAllureСлужебный/Module.bsl`

### ✅ Этап 3: Настройка Allure тегов для smoke тестов
- Добавлена настройка Allure тегов в модуль `ДТОткрытиеФорм`
- Установлены теги: `Epic("Smoke tests")`, `Suite("Дымовые тесты")`, `ParentSuite("Smoke tests")`
- **Файл**: `exts/smoke/src/CommonModules/ДТОткрытиеФорм/Module.bsl`

### ✅ Дополнительно
- Создан README файл с подробным описанием исправления
- Все изменения обратно совместимы
- Добавлены комментарии к коду

## Результат
Теперь дымовые тесты будут корректно отображаться в Allure отчете с `parentSuite: "Smoke tests"` вместо `"Unit tests"`.
